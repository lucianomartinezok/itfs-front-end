<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Países - REST Countries API</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f0f4f8;
      color: #333333;
    }

    .country-card {
      border: none;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      margin-bottom: 20px;
      transition: transform 0.2s ease;
    }

    .country-card:hover {
      transform: scale(1.05);
    }

    .country-flag {
      height: 150px;
      object-fit: contain;
    }

    .country-name {
      font-size: 1.2rem;
      font-weight: bold;
    }

    .country-info {
      font-size: 1.1rem;
      color: #555555;
    }

    .card-body {
      padding: 15px;
    }

    .btn-primary {
      background-color: #ff7f50;
      border: none;
    }

    .btn-primary:hover {
      background-color: #ff6347;
    }

    .filter-section {
      margin-bottom: 20px;
    }
    
    .filter-section h5 {
      margin-bottom: 10px;
    }

  </style>
</head>
<body>
  <div class="container mt-5">
    <h1 class="text-center mb-3">Países de REST Countries API</h1>
    <h4 class="text-center mb-4" id="total-countries">Cargando...</h4>

    <h5 class="mt-4">Filtrar por letra inicial</h5>
            <div id="alphabet-filter" class="mb-4">
            <!-- Botones de A a Z -->
            <button class="btn btn-outline-primary" onclick="filterByLetter('A')">A</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('B')">B</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('C')">C</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('D')">D</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('E')">E</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('F')">F</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('G')">G</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('H')">H</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('I')">I</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('J')">J</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('K')">K</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('L')">L</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('M')">M</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('N')">N</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('O')">O</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('P')">P</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('Q')">Q</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('R')">R</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('S')">S</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('T')">T</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('U')">U</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('V')">V</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('W')">W</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('X')">X</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('Y')">Y</button>
            <button class="btn btn-outline-primary" onclick="filterByLetter('Z')">Z</button>
            </div>

    <div class="filter-section text-center">
      <h5>Ordenar alfabéticamente</h5>
      <div>
        <input type="radio" name="alphabetical" id="az" value="az">
        <label for="az">A - Z</label>

        <input type="radio" name="alphabetical" id="za" value="za">
        <label for="za">Z - A</label>
      </div>

      <h5 class="mt-4">Filtrar por continente</h5>
      <button class="btn btn-secondary" onclick="filterByContinent('Africa')">África</button>
      <button class="btn btn-secondary" onclick="filterByContinent('Americas')">Américas</button>
      <button class="btn btn-secondary" onclick="filterByContinent('Asia')">Asia</button>
      <button class="btn btn-secondary" onclick="filterByContinent('Europe')">Europa</button>
      <button class="btn btn-secondary" onclick="filterByContinent('Oceania')">Oceanía</button>
    </div>
    <div class="filter-section text-center">
    <button class="btn btn-danger mt-3" onclick="clearFilters()">Limpiar Filtros</button>
</div>
    <div class="row" id="country-list">
      <!-- Aquí se mostrarán los países -->
    </div>
  </div>

  <script>
    // URL de la REST Countries API
    const apiUrl = 'https://restcountries.com/v3.1/all';
    let countriesData = [];

    // Función para mostrar el total de países
    function displayTotalCountries(count) {
      document.getElementById('total-countries').textContent = `Total de países: ${count}`;
    }

    // Función para crear tarjetas de países
    function createCountryCard(country) {
      return `
        <div class="col-md-4">
          <div class="card country-card">
            <img src="${country.flags.svg}" class="card-img-top country-flag" alt="Bandera de ${country.name.common}">
            <div class="card-body">
            
            <h5 class="country-name">${country.name.common}</h5>
            <p class="country-info">Capital: ${country.capital ? country.capital[0] : 'N/A'}</p>
            <p class="country-info">Población: ${country.population.toLocaleString()}</p>
            <p class="country-info">Región: ${country.region}</p>
            </div>
          </div>
        </div>
      `;
    }

    let selectedContinent = "";
let selectedLetter = "";

    // Función para mostrar los países
    function displayCountries(countries) {
      const countryList = document.getElementById('country-list');
      countryList.innerHTML = ''; // Limpiar lista actual
      countries.forEach(country => {
        countryList.innerHTML += createCountryCard(country);
      });
    }

    // Función para filtrar por letra inicial
    function filterByLetter(letter) {
  selectedLetter = letter;
  applyFilters();
}

function filterByContinent(continent) {
  selectedContinent = continent;
  applyFilters();
}


function applyFilters() {
  let filteredCountries = countriesData;

  // Filtrar por continente si está seleccionado
  if (selectedContinent) {
    filteredCountries = filteredCountries.filter(country => country.region === selectedContinent);
  }

  // Filtrar por letra inicial si está seleccionada
  if (selectedLetter) {
    filteredCountries = filteredCountries.filter(country => country.name.common.startsWith(selectedLetter));
  }

  // Mostrar los países filtrados
  displayCountries(filteredCountries);
}

    // Función para ordenar alfabéticamente
    function sortAlphabetically(order) {
      const sortedCountries = [...countriesData].sort((a, b) => {
        if (order === 'az') {
          return a.name.common.localeCompare(b.name.common);
        } else if (order === 'za') {
          return b.name.common.localeCompare(a.name.common);
        }
      });
      displayCountries(sortedCountries);
    }

// Función para limpiar los filtros y vaciar el contenido del div country-list
function clearFilters() {
  // Restablecer los filtros
  selectedContinent = "";
  selectedLetter = "";

  // Limpia el contenido de 'country-list'
  const countryList = document.getElementById('country-list');
  countryList.innerHTML = "";  // Borra el contenido

  // Opcional: Actualizar la cantidad de países disponibles a 0
  document.getElementById('country-count').innerText = "Cantidad de países: 0";
}


    // Llamada a la REST Countries API para obtener los países
    fetch(apiUrl)
      .then(response => response.json())
      .then(data => {
        countriesData = data; // Guardar los países
        displayTotalCountries(countriesData.length); // Mostrar total de países

        // Añadir evento de cambio a los filtros
        document.querySelectorAll('input[name="alphabetical"]').forEach(radio => {
          radio.addEventListener('change', (event) => {
            sortAlphabetically(event.target.value);
          });
        });
      })
      .catch(error => console.error('Error al cargar los países:', error));
  </script>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
